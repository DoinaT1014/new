if (self.CavalryLogger) { CavalryLogger.start_js(["yJj2z"]); }

__d('StaleVideoMonitor',['performanceNow','EventEmitter','SubscriptionsHandler','debounce','EventListener'],(function a(b,c,d,e,f,g){var h,i,j=1500;h=babelHelpers.inherits(k,c('EventEmitter'));i=h&&h.prototype;function k(l){'use strict';i.constructor.call(this);this.$StaleVideoMonitor1=new (c('SubscriptionsHandler'))();this.$StaleVideoMonitor2=l.currentTime;this.$StaleVideoMonitor3=c('performanceNow')();var m=c('debounce')(function(){if(l.paused||l.playbackRate<=0)return;var o=l.currentTime,p=l.buffered,q=false,r=void 0;for(r=0;r<p.length;++r){var s=p.start(r),t=p.end(r);if(s>o)break;if(s<=o&&t>=o+1){q=true;break;}}if(q){this.$StaleVideoMonitor4();this.emit('stale',c('performanceNow')()-this.$StaleVideoMonitor3,l.currentTime-this.$StaleVideoMonitor2);}}.bind(this),j),n=function(){this.$StaleVideoMonitor2=l.currentTime;this.$StaleVideoMonitor3=c('performanceNow')();m();}.bind(this);this.$StaleVideoMonitor1.addSubscriptions(c('EventListener').listen(l,'playing',n),c('EventListener').listen(l,'play',n),c('EventListener').listen(l,'timeupdate',n));}k.prototype.$StaleVideoMonitor4=function(){'use strict';if(this.$StaleVideoMonitor1)this.$StaleVideoMonitor1.release();};k.prototype.destroy=function(){'use strict';this.$StaleVideoMonitor4();};f.exports=k;}),null);